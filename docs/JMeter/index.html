<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-JMeter/JMeter">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">JMeter | 知行合一</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://iewiewiew.github.io/img/me.jpeg"><meta data-rh="true" name="twitter:image" content="https://iewiewiew.github.io/img/me.jpeg"><meta data-rh="true" property="og:url" content="https://iewiewiew.github.io/docs/JMeter/"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JMeter | 知行合一"><meta data-rh="true" name="description" content="[TOC]"><meta data-rh="true" property="og:description" content="[TOC]"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://iewiewiew.github.io/docs/JMeter/"><link data-rh="true" rel="alternate" href="https://iewiewiew.github.io/docs/JMeter/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://iewiewiew.github.io/docs/JMeter/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.183e182e.css">
<link rel="preload" href="/assets/js/runtime~main.5e310ca4.js" as="script">
<link rel="preload" href="/assets/js/main.cb284e89.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/me.jpeg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/me.jpeg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">wei</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">目录</a><a href="https://www.processon.com/mindmap/6138112f1e085306ef9fe608" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">技能图谱<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/iewiewiew" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">README</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/AI/">AI</a><button aria-label="打开/收起侧边栏菜单「AI」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Ansible/">Ansible</a><button aria-label="打开/收起侧边栏菜单「Ansible」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/CSBasic/Network">CSBasic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Chaos/ChaosBlade">Chaos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Database/ClickHouse/">Database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/DevOps/">DevOps</a><button aria-label="打开/收起侧边栏菜单「DevOps」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Docker/">Docker</a><button aria-label="打开/收起侧边栏菜单「Docker」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Git/">Git</a><button aria-label="打开/收起侧边栏菜单「Git」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" href="/docs/JMeter/">JMeter</a><button aria-label="打开/收起侧边栏菜单「JMeter」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/JMeter/docker/Docker 运行 JMeter">docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/JMeter/file/beanshell-random">file</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/JMeter/jmeter-set/">README</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Jenkins/">Jenkins</a><button aria-label="打开/收起侧边栏菜单「Jenkins」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Kubernetes/">Kubernetes</a><button aria-label="打开/收起侧边栏菜单「Kubernetes」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Linux/">Linux</a><button aria-label="打开/收起侧边栏菜单「Linux」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Middleware/Apollo/">Middleware</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Mixinfo/BigData/大数据">Mixinfo</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/SoftwareTest/AppTest">SoftwareTest</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">JMeter</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>JMeter</h1></header><p>[TOC]</p><h1 align="center">JMeter</h1><blockquote><p>By：weimenghua<br>
<!-- -->Date：2022.09.18<br>
<!-- -->Description：JMeter 接口测试</p></blockquote><p><strong>参考资料</strong><br>
<a href="https://github.com/apache/jmeter" target="_blank" rel="noopener noreferrer">JMeter 源码</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-环境搭建">1. 环境搭建<a href="#1-环境搭建" class="hash-link" aria-label="1. 环境搭建的直接链接" title="1. 环境搭建的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-安装-jdkjmeterant">1.1 安装 JDK+JMeter+Ant<a href="#11-安装-jdkjmeterant" class="hash-link" aria-label="1.1 安装 JDK+JMeter+Ant的直接链接" title="1.1 安装 JDK+JMeter+Ant的直接链接">​</a></h3><ol><li>安装软件</li></ol><p>1.1 安装 JDK</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://www.oracle.com/java/technologies/downloads/#java8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar -zxvf jdk-8u351-linux-x64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>1.2 安装 Ant</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget --no-check-certificate https://dlcdn.apache.org//ant/binaries/apache-ant-1.9.16-bin.tar.gz &amp;&amp; tar -zxvf apache-ant-1.9.16-bin.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>1.3 安装 JMeter</p><p><a href="https://jmeter.apache.org/download_jmeter.cgi" target="_blank" rel="noopener noreferrer">JMeter 下载地址</a><br>
<a href="https://dlcdn.apache.org//jmeter/binaries/" target="_blank" rel="noopener noreferrer">JMeter 下载地址2</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget --no-check-certificate https://dlcdn.apache.org//jmeter/binaries/apache-jmeter-5.5.tgz &amp;&amp; tar -zxvf apache-jmeter-5.5.tgz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>配置环境变量</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">踩坑：执行以下命令时识别不了$，需转义</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt;&gt; /etc/profile &lt;&lt; EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export JAVA_HOME=/root/software/jdk1.8.0_351</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ANT_HOME=/root/software/apache-ant-1.9.16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export JMETER_HOME=/root/software/apache-jmeter-5.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=$JAVA_HOME/bin:$JMETER_HOME/bin:$ANT_HOME/bin:$PATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JMETER_HOME/lib/ext/ApacheJMeter_core.jar:$JMETER_HOME/lib/jorphan.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PATH=\$JAVA_HOME/bin:\$JMETER_HOME/bin:\$ANT_HOME/bin:\$PATH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CLASSPATH=.:\$JAVA_HOME/jre/lib/rt.jar:\$JAVA_HOME/lib/dt.jar:\$JAVA_HOME/lib/tools.jar:\$JMETER_HOME/lib/ext/ApacheJMeter_core.jar:\$JMETER_HOME/lib/jorphan.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /etc/profile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>检查</li></ol><p>3.1、查看 jdk 安装位置</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -verbose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>3.2、查看环境变量</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo $JAVA_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $ANT_HOME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo $JMETER_HOME</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>3.3、查看应用版本</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ant -version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmeter -v</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-配置-jmeterant">1.2 配置 JMeter+Ant<a href="#12-配置-jmeterant" class="hash-link" aria-label="1.2 配置 JMeter+Ant的直接链接" title="1.2 配置 JMeter+Ant的直接链接">​</a></h3><ol><li>将 JMeter 的 extras 目录下的 ant-jmeter-1.1.1.jar 文件复制到 Ant 安装目录的 lib 目录下</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /root/software/apache-jmeter-5.5/extras/ant-jmeter-1.1.1.jar /root/software/apache-ant-1.9.16/lib/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">检查：ls /root/software/apache-ant-1.9.16/lib/ |grep jmeter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>将 JMeter 的 lib 目录下，把 serializer-2.7.2.jar、xalan-2.7.2.jar 文件复制到 Ant 的 lib 目录下</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /root/software/apache-jmeter-5.5/lib/serializer-2.7.2.jar /root/software/apache-ant-1.9.16/lib/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">检查：ls /root/software/apache-ant-1.9.16/lib/ |grep serializer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cp /root/software/apache-jmeter-5.5/lib/xalan-2.7.2.jar /root/software/apache-ant-1.9.16/lib/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">检查：ls /root/software/apache-ant-1.9.16/lib/ |grep xalan</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>在网站上下载 commons-email.jar、activation-1.1.1.jar、javax.mail.jar 包，复制到 Ant 安装目录的 lib 目录下</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://commons.apache.org/proper/commons-email/download_email.cgi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://www.java2s.com/Code/Jar/a/Downloadactivation111jar.htm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://github.com/javaee/javamail/releases/download/JAVAMAIL-1_6_2/javax.mail.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>将有一个 jmeter.results.shanhe.me.xsl 模版下载并放到 JMeter 下的 extras 目录下</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">原：/root/software/apache-jmeter-5.5/extras/jmeter-results-detail-report_21.xsl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">检查：ls /root/software/apache-jmeter-5.5/extras |grep shanhe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>修改 jmeter.properties</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vim /root/software/apache-jmeter-5.5/bin/jmeter.properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmeter.save.saveservice.output_format=xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmeter.save.saveservice.response_data=true //展示响应数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmeter.save.saveservice.samplerData=true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>配置 build.xml</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在 JMeter 的目录下新建目录 testcase，在 testcase 新建 build.xml 文件，新建 html、jtl、script 目录，将 jmx 脚本放到 script 目录下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /root/software/apache-jmeter-5.5/testcase &amp;&amp; ant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /root/software/apache-jmeter-5.5/testcase &amp;&amp; ant -buildfile linux-build.xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-执行-jmeter-脚本">1.3 执行 JMeter 脚本<a href="#13-执行-jmeter-脚本" class="hash-link" aria-label="1.3 执行 JMeter 脚本的直接链接" title="1.3 执行 JMeter 脚本的直接链接">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jmeter -n -t [jmx file] -l [results file] -e -o [Path to web report folder]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmeter -n -t /root/software/demo.jmx -l result.jtl -e -o /root/software/report/`date +%Y%m%d%H%M%S`/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">本机：/Users/menghuawei/software/apache-jmeter-5.5/bin/jmeter -n -t JMeter 集合.jmx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">踩坑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">报错1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">An error occurred: Error in NonGUIDriver Problem loading XML from:&#x27;/root/software/demo.jmx&#x27;. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cause:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CannotResolveClassException: kg.apc.jmeter.vizualizers.CorrectedResultCollector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解决1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">下载地址：https://jmeter-plugins.org/install/Install/，将 jmeter-plugins-manager-1.7.jar 复制到 Jmeter 的 Lib 目录下面的 ext 目录下面，然后重新启动。好像没用？然后我把压测报告的结果树删除就可以了。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-搭建-jmeter-分布式集群">1.4 搭建 JMeter 分布式集群<a href="#14-搭建-jmeter-分布式集群" class="hash-link" aria-label="1.4 搭建 JMeter 分布式集群的直接链接" title="1.4 搭建 JMeter 分布式集群的直接链接">​</a></h3><p>修改/root/software/apache-jmeter-5.5/bin/jmeter.properties
控制机 master 配置</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1、server.rmi.ssl.disable=true </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2、server_port=1099   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3、remote_hosts=127.0.0.1,127.0.0.2:1099,127.0.0.3:1099</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>压力机 slave 配置</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1、server.rmi.ssl.disable=true    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2、server_port=1099                      该端口配合主机的 remote_hots 端口           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3、server.rmi.localport:1009     该端口对应压力机启动的端口，最好将该端口同 server_port 端口设置为同一端口</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>启动 master-jmeter</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/root/software/apache-jmeter-5.5/bin/jmeter-server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>启动 master-slave</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/root/software/apache-jmeter-5.5/bin/jmeter-server -Djava.rml.server.hostname=127.0.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/root/software/apache-jmeter-5.5/bin/jmeter-server -Djava.rml.server.hostname=127.0.0.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改/root/software/apache-jmeter-5.5/bin/jmeter-server （替换为实际的 ip 地址）</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RMI_HOST_DEF=-Djava.rmi.server.hostname=127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RMI_HOST_DEF=-Djava.rmi.server.hostname=127.0.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RMI_HOST_DEF=-Djava.rmi.server.hostname=127.0.0.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>master 执行非 gui 执行命令：jmeter -n -t test.jmx -r -l result.jtl -e -o report_dir/report_name </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jmeter -n -t [jmx file] -l [results file] -e -o [Path to web report folder]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-n   非 gui 运行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-t   test.jmx  指定运行文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-r   启动所有 slave 节点的机器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-R   127.0.0.1,127.0.0.2  指定 slave 节点机器启动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-l   result.jtl  指定 jtl 信息存储文件名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-e   运行完成后生产 html 报告</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-o   report_dir/report_name 指定 html 报告存放位置且文件夹必须为空</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-j   log/loger  指定 jmeter.log 存放位置</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>tips：
remote_hosts=127.0.0.1 若 master，作为压力机，需要删除 127.0.0.1改成本机 IP，本机的 port 也需要打开，并且 master 机器也要启动 jmeter-server  bin 目录下执行 ./jmeter-server</p><p>杀掉 JMeter 进程</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ps -ef | grep jmeter | grep -v grep | awk &#x27;{ print $2 }&#x27; | xargs kill -9 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>验证分布式集群搭建成功
假设有3台机器，设置并发数1，启动日志会输出启动3个</p><p>踩坑
报错：使用 java 远程启动 jmeter 服务报错，报错内容：Neither the JAVA_HOME nor the JRE_HOME environment variable is defined
解决：在 修改/root/software/apache-jmeter-5.5/bin/jmeter-server 顶部添加以下命令</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export JAVA_HOME=/root/software/jdk1.8.0_351</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export JRE_HOME=/root/software/jdk1.8.0_351/jre</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-jmeter-目录结构">1.5 JMeter 目录结构<a href="#15-jmeter-目录结构" class="hash-link" aria-label="1.5 JMeter 目录结构的直接链接" title="1.5 JMeter 目录结构的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/JMeter_Catalog-269e87035fa56cd0bdcb8aefd3dd21ac.png" width="244" height="308" class="img_ev3q"></p><ul><li>bin 二进制文件目录，包括配置文件、启动文件、启动jar包、示例脚本。比如Windows和Linux系统的两个启动脚本</li><li>docs API离线帮助文档。</li><li>extras 辅助功能，可用于Ant、Jenkins集成。</li><li>lib lib根目录下存放JMeter基础jar包，lib/ext目录下存放第三方或自定义扩展jar包。</li><li>licenses 证书文本文件。</li><li>printable_docs 离线帮助文档。</li><li>LICENSE 证书说明。</li><li>NOTICE 版权声明。</li><li>README 简介。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="16-jmeter-配置">1.6 JMeter 配置<a href="#16-jmeter-配置" class="hash-link" aria-label="1.6 JMeter 配置的直接链接" title="1.6 JMeter 配置的直接链接">​</a></h3><p>jvm参数优化 不要超过物理内存的四分之一。jmeter/bin目录下，vi jmeter，修改HEAP的size大小，默认1024M，可以设置成2048M
HEAP=&quot;-Xms2g -Xmx2g -XX:MaxMetaspaceSize=256m&quot;。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="17-一键运行-jmx">1.7 一键运行 JMX<a href="#17-一键运行-jmx" class="hash-link" aria-label="1.7 一键运行 JMX的直接链接" title="1.7 一键运行 JMX的直接链接">​</a></h3><p><a href="https://github.com/iewiewiew/jmeter-test" target="_blank" rel="noopener noreferrer">一键运行 JMX</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-组件教程">2. 组件教程<a href="#2-组件教程" class="hash-link" aria-label="2. 组件教程的直接链接" title="2. 组件教程的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试计划列表">测试计划列表<a href="#测试计划列表" class="hash-link" aria-label="测试计划列表的直接链接" title="测试计划列表的直接链接">​</a></h3><p>目录结构：包括父节点和子节点。根节点是测试计划，子节点包含：线程组、配置元素、监听器、定时器、前置处理器、后置处理器、断言、测试片段。</p><p><img loading="lazy" src="/assets/images/添加测试计划-b194eda27d21064e7bb8243e9ed73a95.png" width="708" height="298" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试组件列表">测试组件列表<a href="#测试组件列表" class="hash-link" aria-label="测试组件列表的直接链接" title="测试组件列表的直接链接">​</a></h3><p><img loading="lazy" src="/assets/images/测试组件-5bc9f7f01fcc72b0266d6b3b3f82a3f0.png" width="406" height="599" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-线程用户">2.1 线程（用户）<a href="#21-线程用户" class="hash-link" aria-label="2.1 线程（用户）的直接链接" title="2.1 线程（用户）的直接链接">​</a></h3><p>进程和线程的关系：“进程是操作系统分配资源的最小单位，线程是程序执行的最小单位”。</p><p>JMeter 用户就是线程。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="211-基本线程组">2.1.1 基本线程组<a href="#211-基本线程组" class="hash-link" aria-label="2.1.1 基本线程组的直接链接" title="2.1.1 基本线程组的直接链接">​</a></h4><ul><li>Thread Group----模拟用户数，每一个线程就相当于一个虚拟的用户</li><li>setUp Thread Group----用于执行测试之前的初始化操作</li><li>tearDown Thread Group----用于执行测试结束之后的回收工作</li></ul><p><img loading="lazy" src="/assets/images/基本线程组-dccbafe5bed213e9dbb18dbbe90089df.png" width="961" height="405" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="212-性能相关线程组">2.1.2 性能相关线程组<a href="#212-性能相关线程组" class="hash-link" aria-label="2.1.2 性能相关线程组的直接链接" title="2.1.2 性能相关线程组的直接链接">​</a></h4><p>注：需安装插件</p><ul><li>bzm - Arrivals Thread Group----到达线程组</li><li>bzm - Concurrency Thread Group----阶梯控制线程数并发（推荐）</li><li>bzm - Free-Form Arrivals Thread Group</li><li>jp@gc - Stepping Thread Group----阶梯控制线程数并发（不推荐）</li><li>jp@gc - Ultimate Thread Group----阶梯控制线程数并发（不推荐）</li></ul><p><strong>1、线程组（Thread Group）</strong></p><ul><li>线程数：${thread_count}</li><li>循环次数：${load_count}</li><li>持续时间(秒)：${load_time}</li><li>启动延迟(秒)：${delay_time}</li></ul><p>怎样计算 Ramp-up period 时间？<br>
<!-- -->Ramp-up period 是指每个请求发生的总时间间隔，单位是秒。如果 Number of Threads 设置为5，而 Ramp-up period 是10，那么每个请求之间的间隔就是10／5，也就是2秒。Ramp-up period 设置为0，就是同时并发请求。</p><p><strong>2、阶梯控制线程数并发（bzm - Concurrency Thread Group）</strong></p><ul><li>目标并发数：${target_num}  </li><li>加速时间：${ramp_up_time}  </li><li>加速步骤计数：${ramp_up_step_count}  </li><li>保持目标费率时间：${hold_time}</li></ul><p>参数说明</p><ul><li>target concurrency：目标并发数</li><li>ramp up time（min）：加速时间</li><li>ramp-up steps count：加速步骤计数</li><li>hold target rate time（min）：保持目标费率时间</li><li>thread iterations limit：线程迭代次数限制</li><li>log threads status into file：将线程状态记录到文件</li></ul><p>举例</p><ul><li>100个线程组，加速时间为5分钟，10个加速步骤，保持目标费率10分钟：</li><li>10个加速步骤，每步10个线程组；</li><li>5分钟/10步=0.5，每步0.5分钟；即每0.5分钟加载十个线程组，直到达到100个；</li><li>达到100个线程组之后，所有这些线程组将继续运行，加压十分钟。</li></ul><p><img loading="lazy" src="/assets/images/阶梯加压线程组-69fb9743b2a6f2d4b0449f2a6bc9bcac.png" width="1774" height="1436" class="img_ev3q"></p><ul><li>一个线程组内的多个请求是顺序执行的</li><li>不同线程组内的请求是并行执行的</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-组件">2.2 组件<a href="#22-组件" class="hash-link" aria-label="2.2 组件的直接链接" title="2.2 组件的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="取样器">取样器<a href="#取样器" class="hash-link" aria-label="取样器的直接链接" title="取样器的直接链接">​</a></h4><ol><li>正则表达式提取器
Cookie 示例</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Set-Cookie: XXL_JOB_LOGIN_IDENTITY=7b226964223a312c22757365726e616d65223a2261646d696e222c2270617373776f7264223a226531306164633339343962613539616262653536653035376632306638383365222c22726f6c65223a312c227065726d697373696f6e223a6e756c6c7d;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>正则表达式：Set-Cookie: (.*);Path=/;HttpOnly
注意1：如果 cookie 前面带着空格，则正则里面也加一个空格即可
注意2：把 HTTP Cookie 管理器放到请求的上面而不是里面（迷惑？）
添加 DeBug Sampler 查看是否提取成功</p><p>正则表达式提取器：右键添加 --&gt; 后置处理器 --&gt; 正则表达式处理器</p><p>正则表达式为：&quot;token&quot;:&quot;(.+?)&quot;   /  TOKEN:(.+?)&quot;}  （token 表示 key 名）
模板：$1$</p><p><img loading="lazy" src="/assets/images/正则表达式处理器-20cd69330e6ff1286330b0daa5d4127a.png" width="1130" height="379" class="img_ev3q"></p><ol start="2"><li>JSON 提取器</li></ol><p><strong>1、添加 JSON 提取器</strong></p><p>1、添加 JSON 提取器
在线程组右键 &gt; 添加 &gt; 后置处理器 &gt; JSON 提取器 （注：JSON 提取器要放在需要提取响应的接口后面）</p><p>2、JSON 提取器参数说明</p><ul><li>Names of created variables：这是提取值后存储的变量名，用于后面的引用</li><li>JSON Path expressions：JSON path 表达式，详细看下方</li><li>Match No.（0 for Random）：0随机；n 取第几个匹配值；-1匹配所有，后续引用用 变量名_N 取第 N 个值</li><li>Default Values：可以给 error 也可以给0，根据情况调整</li></ul><p><strong>2、JSON path 表达式</strong></p><p>JSON 串 []表示对象组成的数组，{}表示对象。
例如要获取 id，可写$.data.id，$表示根元素，然后一级级属性往下去找，先找到 data，再往下子节点找到 id；也可写$..id，直接从根元素去递归查找到 id；如果只有1级目录，直接$.msg 即可；获取 token 同理。
可设置查看格式为 JSON Path Tester，在下方进行 JSON 路径表达式测试。</p><p><strong>3、JSON path 提取多个值</strong></p><p>JSON 路径表达式，分号隔开。<br>
<!-- -->注意：下面所有参数都得是<!-- -->*<!-- -->*;<!-- -->*<!-- -->*的格式，否则会出现越界的报错！</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">data[-1] ：获取所有数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$data.data[-1].initTransNo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提取多个值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">比如要提取 items 列表里所有的 friendId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$..friendId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$..[*].friendId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$.data.items[*].friendId</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>测试 JSON 提取器</p><p>在查看结果树页面，选择某一条测试结果，切换选择到 JSON Path Tester，在 JSON Path Expression 中输入提取规则，例如：$.data<!-- -->[*]<!-- -->.displayName 即可查看结果</p><p><img loading="lazy" src="/assets/images/test_json_excrt-139e63cd94686b72cccb02ef1cd2f9ae.png" width="886" height="594" class="img_ev3q"></p><ol start="3"><li><p>OS 进程取样器
返回码0表示成功，1表示失败，128也是表示失败（1和128的区别是？）</p></li><li><p>SSH Command</p></li></ol><p>在选项 &gt; Plugins Manager 搜索 SSH 插件进行安装并重启 JMeter
在线程组右键 &gt; 添加取样器 &gt; 选择 SSH Command，填写 Hostname、Port、User Name、Password 等信息</p><p><img loading="lazy" src="/assets/images/SSH-ab57755db449b0eeaffd3d30831ad7e5.png" width="1209" height="760" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="逻辑控制器">逻辑控制器<a href="#逻辑控制器" class="hash-link" aria-label="逻辑控制器的直接链接" title="逻辑控制器的直接链接">​</a></h4><ol><li>Include控制器</li></ol><p>添加Include控制器，选择测试计划，可使用相对路径或者绝对路径，下面的例子 baidu.jmx 是一个测试片段。</p><p><img loading="lazy" src="/assets/images/include控制器-cc18957af162bb34e098af97169e2d96.png" width="1209" height="785" class="img_ev3q"></p><p><img loading="lazy" src="/assets/images/测试片段-35b91f09d26624a93eaa52e5ba49a46b.png" width="1209" height="785" class="img_ev3q"></p><ol start="2"><li>IF 控制器</li></ol><p>右键添加 &gt; 逻辑控制器 &gt; 如果（If）控制器，注意勾选2个方框<br>
<!-- -->判断 true 或者 false，可用做判断上一个请求是否成功来决定是否走下一个请求<br>
<!-- -->${__groovy(&#x27;${title}&#x27;==&#x27;张三&#x27;,)}  </p><p>注意：<br>
<!-- -->1、条件判断语句若是字符串，则需要用引号包围参数，如：&quot;user&quot; == &quot;test001&quot;；<br>
<!-- -->2、If Controller 之下的请求才会受到 If 控制器的约束，若是平级则不会受约束，因此建议将业务请求放在 If 控制器之下进行测试。</p><ol start="3"><li>吞吐量控制器（Throughput Controller） </li></ol><p>参数说明</p><ul><li>Total Executions（执行总次数，N 为整数）</li><li>Percent executions（执行百分比，N 为1-100整数）</li><li>Per User ：是否针对每个用户，在线程数为1的情况下，勾不勾选，执行效果一样</li><li>Per User：表示是否要在每个线程组上单独应用控制器的设置。比如说，如果在</li><li>Total executions 模式下填写了50的吞吐量，
勾选了 Per User，那么控制器的子元件会执行线程数 * 50次；
不勾选 Per User，那么控制器的子元件会执行50次。
百分比模式下的执行次数：线程数循环次数（N/100）</li></ul><p>踩坑：设置的总数必须是可以除出整数的，如果除不尽就会报错。</p><p><img loading="lazy" src="/assets/images/吞吐量控制器-5d5a3608550a9d9ca57a502f0664fd79.png" width="2406" height="1456" class="img_ev3q"></p><ol start="4"><li>权重控制器（Weighted Switch Controller）  </li></ol><p>搜索：Weighted Switch Controller</p><p>注意：在权重控制器下添加请求，此页面自动加载请求列表；设置线程组循环次数，权重才有效（感觉不太合理？）</p><p><img loading="lazy" src="/assets/images/权重控制器-df5ccdb948e67a22f88cddae60a23f5d.png" width="1209" height="256" class="img_ev3q"></p><ol start="5"><li>临界部分控制器</li></ol><p>临界部分控制器确保其子元素（取样器/控制器等）每次只允许一个线程执行，不允许并行执行，功能类似同步锁。（按顺序执行）</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="前后置处理器">前后置处理器<a href="#前后置处理器" class="hash-link" aria-label="前后置处理器的直接链接" title="前后置处理器的直接链接">​</a></h4><p><strong>JMeter 预 &amp; 后置处理程序 Beanshell</strong></p><p><strong>1、beanshell 是什么</strong></p><p>JMeter BeanShell 是 JMeter 中的一个组件，用于在测试计划中添加 BeanShell 脚本。BeanShell 脚本可以在 JMeter 中用于许多不同的任务，例如动态生成测试数据、计算测试结果、修改请求参数等。</p><p>BeanShell 组件允许用户编写 BeanShell 脚本，并在测试计划中使用这些脚本。用户可以通过预处理器、后处理器、断言、监听器等组件来指定 BeanShell 脚本的执行方式。</p><p><strong>beanshell 的使用场景</strong></p><ul><li>操作变量</li><li>操作属性</li><li>自定义函数</li><li>引用外部 java 文件</li><li>引用外部 class 文件</li><li>引用外部 Jar 包</li><li>其它用法(接受参数， log 等)</li></ul><p><strong>2、预处理程序 beanshell</strong></p><ol><li><p>添加 jar 包：在测试计划右键 --&gt; 添加目录或 jar 包到 ClassPath</p></li><li><p>添加 BeanShell 预处理程序  /  BeanShell 后置处理程序</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import encryption;  //import 加密解密的类</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">encryption e = new encryption();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String name = e.add(&quot;我是原始入参&quot;); //入参</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(name); //打印日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;parameter&quot;,name);//需要使用该命令，把加密后的参数放到 parameter 中，供发起请求后使用。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>将 parameter 作为参数传给 idCardNo</li></ol><p><strong>3、后置处理程序 beanshell</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.jmeter.samplers.SampleResult;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取取样器结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SampleResult result = ctx.getPreviousResult();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取请求头</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String RequestHeaders = result.getRequestHeaders();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取响应头</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String ResponseHeaders = result.getResponseHeaders();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取响应码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String responseCode = result.getResponseCode();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取响应数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String responseData = result.getResponseDataAsString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取 url</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">URL url = result.getURL();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;请求头：&quot; + RequestHeaders);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;响应头：&quot; + ResponseHeaders);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;响应码：&quot; + responseCode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;响应体：&quot; + responseData);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>4、在 beanshell 里生成随机数</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String[] str= new String[]{&quot;张三&quot;, &quot;李四&quot;, &quot;王五&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Random random = new Random();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = random.nextInt(str.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;str&quot;,str[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;随机字符:&quot; + str[i])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>5、beanshell 引入 java 类</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">注：可使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注：IDEA 打 jar 包时一定要有个 main 方法的 java 类，这个 main 方法可以是只有一个输出语句就行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注：有时 new 一个对象出来不可行(迷惑)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">addClassPath(&quot;D:\\software\\IdeaProjects\\wei-notebook\\jmeter\\jar 包\\java-generator.jar&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import cn.binarywang.tools.generator.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import cn.binarywang.tools.generator.bank.BankCardNumberGenerator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String generatedName = ChineseNameGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;generatedName&quot;,generatedName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;姓名：&quot; + generatedName);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String generatedName2 = ChineseNameGenerator.getInstance().generateOdd();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;generatedName2&quot;,generatedName2);        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;姓名2：&quot; + generatedName2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String idCard=ChineseIDCardNumberGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;idCard&quot;,idCard);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;身份证：&quot; + idCard);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String generatedMobileNum= ChineseMobileNumberGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;generatedMobileNum&quot;,generatedMobileNum);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;手机号：&quot; + generatedMobileNum);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String generatedEmail= EmailAddressGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;generatedEmail&quot;,generatedEmail);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;邮箱：&quot; + generatedEmail);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String bankCardNo= BankCardNumberGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;bankCardNo&quot;,bankCardNo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;银行卡号：&quot; + bankCardNo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String generatedAddress= ChineseAddressGenerator.getInstance().generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;generatedAddress&quot;,generatedAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;地址：&quot; + generatedAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String issueOrg=ChineseIDCardNumberGenerator.generateIssueOrg();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;issueOrg&quot;,issueOrg);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;机关：&quot; + issueOrg);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="定时器">定时器<a href="#定时器" class="hash-link" aria-label="定时器的直接链接" title="定时器的直接链接">​</a></h4><p><strong>1、固定定时器</strong>
JMeter 中的定时器类似于 loadrunner 中的 pacing 值和 think_time。
1、定时器是在每个 sampler（采样器）之前执行的，而不是之后
2、定时器是有作用域的；当执行一个 sampler 之前时，所有当前作用域内的定时器都会被执行。且所有的 sampler 执行前都会执行定时器
3、如果希望定时器仅应用于其中一个 sampler，则把该定时器作为子节点加入
常用的定时器
1、固定定时器：设置一个固定的延迟时间，单位 ms
2、同步定时器（synchronizing timer）：在该定时器处，使线程等待，一直到指定的线程个数达到后，再一起释放。可以在瞬间制造出很大的压力。它和 loadrunner 的集合点差不多的功能
3、常量控制器：可以控制每分钟 tps 的总量，限制最高
2、吞吐量整形定时器（jp@gc - Throughput Shaping Timer）
参数说明：
Start RPS ：开始运行 RPS，开始后马上加载此数量的请求。
End RPS ：结束时 RPS， 以此数为 RPS 最高控制点，目标是不超过此值，一般来说会在此值附近浮动。
Duration,sec： 线程运行时长。
Per User
若勾选，每个线程会单独计算执行频率
若不勾选（默认），所有线程统一计算执行频率</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="监听器">监听器<a href="#监听器" class="hash-link" aria-label="监听器的直接链接" title="监听器的直接链接">​</a></h4><p>踩坑：三个监听器取其一，否则会出现后面的监听器拿不到数据的情况。
<strong>1、每秒事务数（jp@gc - Transactions per Second）</strong>
TPS：每秒事务数，监控整体趋势、实时平均值走向、稳定性。</p><p><strong>2、单位时间内活动的线程数（jp@gc - Active Threads Over Time）</strong>
阶梯加压线程组需要和 Active Threads Over Time(单位时间内活动的线程数)结合起来，这样能看到动态的阶梯加压效果。</p><p><strong>3、事务响应时间（jp@gc - Response Times Over Time）</strong>
TRT：事务响应时间，监控查看响应时间的实时平均值、整体响应时间走向等。</p><p><strong>4、聚合报告</strong></p><ul><li>Label：每个 JMeter 的 element（例如 HTTP Request）都有一个 Name 属性，这里显示的就是 Name 属性的值</li><li>Samples：请求数——表示这次测试中一共发出了多少个请求，如果模拟10个用户，每个用户迭代10次，那么这里显示100</li><li>Average：平均响应时间——默认情况下是单个 Request 的平均响应时间，当使用了 Transaction Controller 时，以 Transaction 为单位显示平均响应时间</li><li>Median：中位数，也就是 50％ 用户的响应时间</li><li>90% Line：90％ 用户的响应时间</li><li>Min：最小响应时间</li><li>Max：最大响应时间</li><li>Error%：错误率——错误请求数/请求总数</li><li>Throughput：吞吐量——默认情况下表示每秒完成的请求数（Request per Second），当使用了 Transaction Controller 时，也可以表示类似 LoadRunner 的 Transaction per Second 数</li><li>KB/Sec：每秒从服务器端接收到的数据量，相当于 LoadRunner 中的 Throughput/Sec
一般而言，性能测试中我们需要重点关注的数据有：#Samples 请求数，Average 平均响应时间，Min 最小响应时间，Max 最大响应时间，Error% 错误率及 Throughput 吞吐量。</li></ul><p><img loading="lazy" src="/assets/images/聚合报告-5d3939648cddcd477961f47446e85f23.png" width="959" height="222" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="断言">断言<a href="#断言" class="hash-link" aria-label="断言的直接链接" title="断言的直接链接">​</a></h4><p>响应断言</p><p><img loading="lazy" src="/assets/images/响应断言-aa407d0a09d792391831fc329515ec29.png" width="955" height="516" class="img_ev3q"></p><p>JSON断言</p><p><img loading="lazy" src="/assets/images/JSON断言-1b962d1b2f25ab0aa419e6cce5c649f7.png" width="961" height="522" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-使用教程">3. 使用教程<a href="#3-使用教程" class="hash-link" aria-label="3. 使用教程的直接链接" title="3. 使用教程的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="命令规范">命令规范<a href="#命令规范" class="hash-link" aria-label="命令规范的直接链接" title="命令规范的直接链接">​</a></h3><p>压测执行相关参数通过定义 JMeter 属性
在 JMeter 的“用户定义的变量”中定义变量 total_tps（表示混合压测总 TPS）  </p><ul><li>变量名：total_tps </li><li>变量值：${__P(p_total_tps,)} 注意：此处的属性名根据命令行传入名称填写,在执行压测时使用如下命令将参数传入，
<code>jmeter -n -t test.jmx -Jp_total_tps=50</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="参数化">参数化<a href="#参数化" class="hash-link" aria-label="参数化的直接链接" title="参数化的直接链接">​</a></h3><p>在测试计划添加全局变量</p><p><img loading="lazy" src="/assets/images/测试计划全局变量-33a4a6f514eb750626677d20bd471bc3.png" width="965" height="416" class="img_ev3q"></p><p>工具 &gt; 函数助手</p><ul><li>CSV文件读取：${_CSVRead(/tmp/a.text,0,)}</li><li>随机数：${_Random(1,100,)}</li><li>随机字符串：${_RandomString(8,abcd,)}</li><li>时间戳 ${_time(,)} 格式yyy-MM-dd HH:mm:ss</li><li>生成唯一UUID:${_UUID} 全局不重复的字符串</li></ul><p>添加随机数变量： ${__Random(1,100,var_name)}</p><p><img loading="lazy" src="/assets/images/函数助手_随机数-a0ff088c37ffcd5bdc5a2b1c36386c57.png" width="788" height="501" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="连接数据库">连接数据库<a href="#连接数据库" class="hash-link" aria-label="连接数据库的直接链接" title="连接数据库的直接链接">​</a></h3><p>1、JMeter 连接 MySQL</p><p><strong>1.1、导入 JDBC 驱动包</strong><br>
<!-- -->在测试计划（Test Plan）下面把 jdbc 驱动包导入。<br>
<!-- -->MySQL5.7 导入版本： <a target="_blank" href="/assets/files/mysql-connector-java-5.1.38-98edd723a327d5a0eafbee9877d2ae9f.jar">mysql-connector-java-5.1.38.jar</a><br>
<!-- -->MySQL8 导入版本：<a target="_blank" href="/assets/files/mysql-connector-java-8.0.19-8b81825da34676a00f3bc6a4494276ae.jar">mysql-connector-java-8.0.19.jar</a></p><p><img loading="lazy" src="/assets/images/JMeter_MySQL驱动-d300c0b055f0739641c682f050b9eb57.png" width="1518" height="817" class="img_ev3q"></p><p><strong>1.2、添加 JDBC 连接配置</strong>
线程组下添加一个配置元件 JDBC Connection Configuration。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1、Variable Name for created pool：自定义参数，在 JDBC Request 中会用到；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2、Database URL：jdbc:mysql://127.0.0.1:3306/dbname?allowMultiQueries=true&amp;useUnicode=true&amp;serverTimezone=GMT；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">参数说明</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allowMultiQueries=true：一次性执行多个 SQL 语句，每个 SQL 语句以分号（;）隔开，且 QueryType 一定要选择 Callable statement；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">useUnicode=true：解决中文乱码输入问题；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serverTimezone=UTC：UTC 是统一标准世界时间，若不添加，查询时间参数可能会报错；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3、JDBC Driver Class：com.mysql.jdbc.Driver 或者 com.mysql.cj.jdbc.Driver；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">注意：如果 mysql 版本是8.x 的，驱动类是：com.mysql.cj.jdbc.Driver；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4、Username：数据库用户名；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5、Password：数据库密码；</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/assets/images/JDBC连接配置-324d67f9c5c914a9e2da98fba285c074.png" width="1518" height="817" class="img_ev3q"></p><p><strong>1.3、添加 JDBC 请求</strong>
添加一个 Sampler：JDBC Request，加个调试取样器和察看结果树。
注：JDBC Connection Configuration 和 JDBC Request 的 Variable 保持一致。</p><p><img loading="lazy" src="/assets/images/JDBC请求-3afccd93d7c79a3a0b8002e3ecb9354e.png" width="1518" height="817" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查询 SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select * from dbname.`t_table_info`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select id, name, age, create_time from dbname.`t_table_info`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 变量名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">id, name, age, create_time</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>1.4、计数器</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 计数器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting value：1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">递增：1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Maxinum value：${id_#}  # 获取数据最大条数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">引用名称：index  # 设置一个计数器变量，用于后面循环获取数据</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/assets/images/计数器-37bd8b1e1f38925162e6924ec295e0d7.png" width="1518" height="817" class="img_ev3q"></p><p>可在线程组里面的循环次数添加数据总条数，以此来循环获取数据库所有数据。</p><p><img loading="lazy" src="/assets/images/连接数-34616607c9d989a2ed9a49d6203f8b0b.png" width="1518" height="817" class="img_ev3q"></p><p><strong>1.5、JDBC 验证数据</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;id&quot;:&quot;${__V(id_${index},)}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;:&quot;${__V(name_${index},)}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;age&quot;:&quot;${__V(age_${index},)}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;create_time&quot;:&quot;${__V(create_time_${index},)}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/assets/images/JDBC验证数据-f8d996b73a4d491ea40c0b532a5255a9.png" width="1518" height="817" class="img_ev3q"></p><p><strong>1.6、调试取样器</strong></p><p><img loading="lazy" src="/assets/images/调试取样器-092cab42703d61badce594a95ee37157.png" width="1518" height="817" class="img_ev3q"></p><p><strong>2、JMeter 连接 PostgreSQL</strong></p><p><a href="https://jdbc.postgresql.org/download/" target="_blank" rel="noopener noreferrer">JDBC PostgreSQL 驱动下载</a></p><p>与【JMeter 连接 MySQL】类似，区别如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1、Database URL：jdbc:postgresql://127.0.0.1:5432/postgres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2、JDBC Driver class：org.postgresql.Driver</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>3、JMeter 连接 Redis（2023.03.14实践未成功）</strong></p><p><a href="https://jmeter-plugins.org/install/Install/" target="_blank" rel="noopener noreferrer">JMeter 插件下载地址</a></p><p><a target="_blank" href="/assets/files/jmeter-plugins-manager-1.8-be8f75a462c295249affb97908303cf6.jar"></a></p><p>由于 jmeter 本身并没有带有 Redis 的测试入口，我们需要去安装 Redis 插件。<br>
<!-- -->首先，我们下载 jmeter-plugins-manager-1.6.jar 文件，放到 jmeter 的 lib 的 ext 文件夹中，然后重启 jmeter。<br>
<!-- -->然后，在<code>选项</code>菜单下，点击<code>plugin manager</code>，打开插件管理弹窗，选择<code>Available Plugins</code>，在搜索框中，输入 Redis。<br>
<!-- -->然后，选中<code>Redis Data Set</code>，点击<code>Apply Changes and Restart JMeter</code>带自动下载后重启 jmeter。<br>
<!-- -->然后，在 jmeter 的线程组上右键，添加 &gt; 配置元件 &gt; jp@gc - Redis Data Set。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="读取-csv-文件">读取 csv 文件<a href="#读取-csv-文件" class="hash-link" aria-label="读取 csv 文件的直接链接" title="读取 csv 文件的直接链接">​</a></h3><p>1、添加 CSV 数据文件设置</p><p>在线程组右键 &gt; 添加 &gt; 配置元件 &gt; CSV 数据文件设置</p><p><img loading="lazy" src="/assets/images/csv数据文件设置-c822fccd7e6238f44462b58483343838.png" width="1920" height="1001" class="img_ev3q"></p><p>2、CSV 配置</p><ul><li>文件名：CSV 文件路径</li><li>文件编码：UTF-8</li><li>变量名称：CSV 表头</li><li>忽略首行：True False</li><li>分割符：英文逗号</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试-dubbo-接口">测试 Dubbo 接口<a href="#测试-dubbo-接口" class="hash-link" aria-label="测试 Dubbo 接口的直接链接" title="测试 Dubbo 接口的直接链接">​</a></h3><p><strong>参考资料</strong><br>
<a href="https://github.com/thubbo/jmeter-plugins-for-apache-dubbo/wiki/FAQ" target="_blank" rel="noopener noreferrer">dubbo 插件常见问题</a></p><p><strong>插件配置</strong></p><p><a href="https://github.com/thubbo/jmeter-plugins-for-apache-dubbo/releases" target="_blank" rel="noopener noreferrer">jmeter-plugins-for-apache-dubbo 下载地址</a><br>
<a href="https://gitcode.net/mirrors/dubbo/jmeter-plugins-dubbo/-/releases" target="_blank" rel="noopener noreferrer">jmeter-plugins-for-apache-dubbo 下载地址</a></p><p>将下载压缩包解压后，将 dist 文件夹下的 <code>jmeter-plugins-dubbo-x.x.x-jar-with-dependencies</code> 放置到 /jmeter/lib/ext 下，重启 JMeter 即可。</p><p><strong>基本参数</strong></p><p>dubbo 参数：
zookeeper IP:port
接口+方法+参数(paramType 即方法参数，paramValue 即参数值)</p><p><strong>具体例子 </strong><br>
<!-- -->zk 地址：127.0.0.1:2181<br>
<!-- -->接口：test1/com.demo.api.service.ProjectInfoService 接口方法：listByPage<br>
<!-- -->参数：com.demo.api.dto.req.ProjectInfoReq 参数值：{ &quot;capCode&quot;: &quot;demo&quot; }  #注意：如果 value 是数字，也要看类型，如果是字符串则需要加双引号，否则会报错</p><p>如何找接口：<br>
<!-- -->先在代码里面找到 xxxService，再找到对应的方法，方法里面就是参数，通过 IDEA 点击进去，一般是 req 或者 String，<br>
<!-- -->注意:获取的是 req 整个包路径，参数就是 req 里面的参数</p><p><img loading="lazy" src="/assets/images/JMeter_Dubbo-fe754edebc42c4485c420b12c4390964.png" width="1209" height="758" class="img_ev3q"></p><p>各参数说明如下：</p><ul><li>Protocol：注册协议，包括 zookeeper、multicast、Redis、simple；</li><li>Address：注册地址，dubbo 服务的 IP+Port：
①、当使用 zk，address 填入 zk 地址，集群地址使用&quot;，&quot;分隔；
②、使用 dubbo 直连，address 填写直连地址和服务端口；</li><li>Protocol：使用的 dubbo 协议，包括 dubbo、rmi、hessian、webservice、memcached、redis，根据自己的协议类型选择对应的选项即可；</li><li>Timeout：请求超时时间，单位 ms，根据 dubbo 具体配置填写；</li><li>Version：版本，dubbo 不同版本之间差异较大，不同版本之间不能互相调用，这里指定 dubbo 版本，是为了方便识别和说明；</li><li>Retries：异常重试次数（类似这种分布式服务通信框架，大多都有重试机制，是为了保证事务成功率）；</li><li>Cluster：集群类型，包括 failover、failfast、failsafe、failback、failking；</li><li>Group：组类型，如果有的话，根据配置填写即可；</li><li>Connections：连接数，同上，根据配置填写；</li><li>Async：服务处理类型，包括 sync（同步）、async（异步），根据配置填写；</li><li>Loadbalance：负载均衡策略，包括 random（随机）、roundrobin（轮询）、leastactive（最少活跃数）、consistenthash（一致性哈希）；</li><li>Interface：接口名（因为 dubbo 服务大多是开发根据规范自行命名的，因此这里需要填写完整的接口名+包名）；</li><li>Method：当前接口下的方法名，按照开发提供的 API 文档填写即可；</li><li>Args：接口报文，根据 API 文档填写，如上图所示，添加输入行，输入对应的参数类型和值即可（参数类型和值如何定义填写，请参考上面的链接）；
①、paramType：参数支持任何类型，包装类直接使用 java.lang 下的包装类，小类型使用：int、float、shot、double、long、byte、boolean、char，自定义类使用类完全名称；
②、paramValue：基础包装类和基础小类型直接使用值，例如：int 为1，boolean 为 true 等，自定义类与 List 或者 Map 等使用 json 格式数据；</li></ul><p><strong>注意点</strong></p><p>调用 dubbo 接口时需要确保调用平台(consumer)和服务提供平台（provider）网络是联调的，光是能连接到注册中心（zookeeper）是不够的，因为注册中心只是告诉调用者提供者的地址而已。<br>
<!-- -->检测端口是否开放：telnet ip 端口，举例：telnet 127.0.0.1 20880（可在 dubbo-admin 查看端口），ls 查看接口</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="函数">函数<a href="#函数" class="hash-link" aria-label="函数的直接链接" title="函数的直接链接">​</a></h3><p><strong>1、JMeter 函数助手</strong></p><p>Tools --&gt; 函数助手对话框（注：一般在选项，但是我的 JMeter 在 Tools）</p><p><strong>2、JMeter 函数</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">随机生成1到100之间的数值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__Random(1,100,)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">根据字符串&quot;哈哈嘻嘻呵呵啦啦&quot;随机取3个字符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__RandomString(3,哈哈嘻嘻呵呵啦啦,)}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在 beanshell 里面获取随机数</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">String[] str= new String[]{&quot;张三&quot;, &quot;李四&quot;, &quot;王五&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Random random = new Random();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int i = random.nextInt(str.length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars.put(&quot;str&quot;,str[i]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.info(&quot;随机字符:&quot; + str[i])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="上传文件">上传文件<a href="#上传文件" class="hash-link" aria-label="上传文件的直接链接" title="上传文件的直接链接">​</a></h3><p>1、勾选对 POST 使用 multipart/form-data</p><p>2、参数：具体接口的参数</p><p>3、文件名称：上传文件的路径</p><p>4、参数名称：具体接口的参数，一般是 file</p><p>5、MIME 类型：multipart/form-data</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="下载文件">下载文件<a href="#下载文件" class="hash-link" aria-label="下载文件的直接链接" title="下载文件的直接链接">​</a></h3><p>在下载文件接口后面添加 beanshell</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] result = prev.getResponseData(); //这个是获取到请求返回的数据，prev是获取上个请求的返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String file_name = &quot;/.tmp/artifact_BUILD_ARTIFACT.tar.gz&quot;; //代表存放文件的位置和文件名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">File file = new File(file_name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FileOutputStream out = new FileOutputStream(file);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out.write(result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">out.close();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成-csv-测试报告">生成 CSV 测试报告<a href="#生成-csv-测试报告" class="hash-link" aria-label="生成 CSV 测试报告的直接链接" title="生成 CSV 测试报告的直接链接">​</a></h3><p>注：csv 需要写绝对路径</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/Users/menghuawei/software/apache-jmeter-5.5/bin/jmeter -n -t jmeter_all.jmx -l result.jtl -e -o `date +%Y%m%d%H%M%S` -Jcsv.output.dir=/Users/menghuawei/IdeaProjects/my-project/wei-notebook/.tmp/tmp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="非-gui-执行">非 GUI 执行<a href="#非-gui-执行" class="hash-link" aria-label="非 GUI 执行的直接链接" title="非 GUI 执行的直接链接">​</a></h3><ol><li>非 GUI 执行添加参数</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">添加 beanshell 后置处理器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__setProperty(demo1,&quot;demo1&quot;,False)};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__setProperty(demo2,${demo2},False)}; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">引用变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__P(demo1)} ${__P(demo2)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">执行 jmx 时候传参</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">${__P(url,)}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">举例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/Users/menghuawei/software/apache-jmeter-5.5/bin/jmeter -n -t jmeter_demo.jmx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-l result.jtl -e -o `date +%Y%m%d%H%M%S` \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Jurl=http://www.666.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>调试脚本</li></ol><p>把 bin/jmeter.properties 的 jmeter.save.saveservice.output_format=xml 配置为 xml 格式，将集群全部的 /bin/下的 jmeter.properties 文件，搜索 mode=Standard 并打开，若不打开，则集群模式下不会返回具体的详细信息。执行命令 jmeter -n -t demo.jmx -l result.jtl  直接导出 result.jtl， 在 jmeter 的 gui 模式下，导入查看结果树进行错误信息的查看。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="二次开发">二次开发<a href="#二次开发" class="hash-link" aria-label="二次开发的直接链接" title="二次开发的直接链接">​</a></h3><p><strong>开发步骤</strong></p><ul><li>创建 Maven 项目：使用 IDEA 创建一个 Maven 项目</li><li>添加依赖：在项目的 pom.xml 中依赖 ApacheJMeter_java、ApacheJMeter_core，注意与使用的 JMeter 版本保持一致，依赖见附件</li><li>自定义函数：</li><li>添加自定义函数，继承 AbstractFunction 类，并覆写其4个方法</li><li>execute 方法：添加插件逻辑</li><li>getReferenceKey 方法：返回自定义名称函数，用于在 JMeter 中调用</li><li>setParameters 方法：获取传递的参数</li><li>getArgumentDesc：返回参数描述</li><li>注意，自定义函数必须在*.functions 包下</li><li>打包：使用 Maven 工具将插件打包成.jar 文件，在项目下的 target 目录中</li><li>发布：将打包的.jar 文件拷贝到 JMeter 安装目录的 lib/ext 目录中</li><li>重启 JMeter：重新启动 JMeter，此时就可以 JMeter 中使用.jar 包中自定义的函数</li></ul><p>添加依赖</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dependencies&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;groupId&gt;org.apache.jmeter&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;artifactId&gt;ApacheJMeter_core&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;version&gt;5.3&lt;/version&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;groupId&gt;org.apache.jmeter&lt;/groupId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;artifactId&gt;ApacheJMeter_java&lt;/artifactId&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;version&gt;5.3&lt;/version&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/dependency&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dependencies&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-知识碎片">4. 知识碎片<a href="#4-知识碎片" class="hash-link" aria-label="4. 知识碎片的直接链接" title="4. 知识碎片的直接链接">​</a></h2><p>1、问题一</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">执行 jmeter -n -t demo.jmx 报错：main ERROR Unable to locate appender &quot;jmeter-log&quot; for logger config &quot;root&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原因：&lt;Jmeter 安装目录&gt;/bin/log4j2.xml 的日志目录错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">错误：&lt;File name=&quot;jmeter-log&quot; fileName=&quot;/software/apache-jmeter-5.5/bin&quot; append=&quot;false&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正确：&lt;File name=&quot;jmeter-log&quot; fileName=&quot;/software/apache-jmeter-5.5/bin/jmeter.log&quot; append=&quot;false&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>2、问题二<br>
<!-- -->设置线程组的持续时间时，循环次数勾永远（循环次数和持续时间，谁先结束就以谁为准）
设置循环次数，就会非常非常慢，为啥？</p><p>3、问题三
使用 Nginx 代理访问 JMeter 测试报告，浏览器也会有缓存，清空缓存或者使用无痕浏览器访问即可。</p><p>4、查看结果树生成CSV指定相对路径无效
可以使用相对路径名或绝对路径名来指定文件名。相对路径是相对于当前工作目录（默认为 bin/目录）解析的。JMeter 还支持相对于包含当前测试计划（JMX 文件）的目录的路径。如果路径名以~/开头（或 jmeter.save.saveservice.base_prefix JMeter 属性中的任何内容），则假定该路径是相对于 JMX 文件位置的。</p><p>5、不同的csv内容字段名称不能相同，否则后面引用变量都是第一个</p><p>6、File &gt; Merge 合并测试计划</p><p><img loading="lazy" src="/assets/images/JMeter_Merge-a262ad0e263b82b28521596e6fe818fe.png" width="225" height="307" class="img_ev3q"></p><p>swagger 转换为 jmeter</p><p>swagger 文件
<a href="https://gitee.com/api/v5/doc_json?from=file" target="_blank" rel="noopener noreferrer">https://gitee.com/api/v5/doc_json?from=file</a></p><p>下载 swagger 转 jmeter 文件工具包
wget <a href="https://repo1.maven.org/maven2/org/openapitools/openapi-generator-cli/5.3.0/openapi-generator-cli-5.3.0.jar" target="_blank" rel="noopener noreferrer">https://repo1.maven.org/maven2/org/openapitools/openapi-generator-cli/5.3.0/openapi-generator-cli-5.3.0.jar</a> -O openapi-generator-cli.jar</p><p>转换 swagger.json 到 jmeter.jmx 文件</p><p>java -jar openapi-generator-cli.jar generate -i FeHelper-20240719180245.json -g jmeter --skip-validate-spec
java -jar openapi-generator-cli.jar generate -i gitee.postman_collection.json -g jmeter --skip-validate-spec</p><p>Mac 执行 Jmeter 脚本自动闪退 </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Failed to write core dump. Core dumps have been disabled. To enable core dumping, try &quot;ulimit -c unlimited&quot; before starting Java again /Users/menghuawei/software/apache-jmeter-5.5/bin/jmeter: line 200: 49141 Abort trap: 6           &quot;$JAVA_HOME/bin/java&quot; $ARGS $JVM_ARGS $JMETER_OPTS -jar &quot;$PRGDIR/ApacheJMeter.jar&quot; &quot;$@&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Git/分布式版本控制系统"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">分布式版本控制系统</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/JMeter/docker/Docker 运行 JMeter"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Docker 运行 JMeter</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-环境搭建" class="table-of-contents__link toc-highlight">1. 环境搭建</a><ul><li><a href="#11-安装-jdkjmeterant" class="table-of-contents__link toc-highlight">1.1 安装 JDK+JMeter+Ant</a></li><li><a href="#12-配置-jmeterant" class="table-of-contents__link toc-highlight">1.2 配置 JMeter+Ant</a></li><li><a href="#13-执行-jmeter-脚本" class="table-of-contents__link toc-highlight">1.3 执行 JMeter 脚本</a></li><li><a href="#14-搭建-jmeter-分布式集群" class="table-of-contents__link toc-highlight">1.4 搭建 JMeter 分布式集群</a></li><li><a href="#15-jmeter-目录结构" class="table-of-contents__link toc-highlight">1.5 JMeter 目录结构</a></li><li><a href="#16-jmeter-配置" class="table-of-contents__link toc-highlight">1.6 JMeter 配置</a></li><li><a href="#17-一键运行-jmx" class="table-of-contents__link toc-highlight">1.7 一键运行 JMX</a></li></ul></li><li><a href="#2-组件教程" class="table-of-contents__link toc-highlight">2. 组件教程</a><ul><li><a href="#测试计划列表" class="table-of-contents__link toc-highlight">测试计划列表</a></li><li><a href="#测试组件列表" class="table-of-contents__link toc-highlight">测试组件列表</a></li><li><a href="#21-线程用户" class="table-of-contents__link toc-highlight">2.1 线程（用户）</a></li><li><a href="#22-组件" class="table-of-contents__link toc-highlight">2.2 组件</a></li></ul></li><li><a href="#3-使用教程" class="table-of-contents__link toc-highlight">3. 使用教程</a><ul><li><a href="#命令规范" class="table-of-contents__link toc-highlight">命令规范</a></li><li><a href="#参数化" class="table-of-contents__link toc-highlight">参数化</a></li><li><a href="#连接数据库" class="table-of-contents__link toc-highlight">连接数据库</a></li><li><a href="#读取-csv-文件" class="table-of-contents__link toc-highlight">读取 csv 文件</a></li><li><a href="#测试-dubbo-接口" class="table-of-contents__link toc-highlight">测试 Dubbo 接口</a></li><li><a href="#函数" class="table-of-contents__link toc-highlight">函数</a></li><li><a href="#上传文件" class="table-of-contents__link toc-highlight">上传文件</a></li><li><a href="#下载文件" class="table-of-contents__link toc-highlight">下载文件</a></li><li><a href="#生成-csv-测试报告" class="table-of-contents__link toc-highlight">生成 CSV 测试报告</a></li><li><a href="#非-gui-执行" class="table-of-contents__link toc-highlight">非 GUI 执行</a></li><li><a href="#二次开发" class="table-of-contents__link toc-highlight">二次开发</a></li></ul></li><li><a href="#4-知识碎片" class="table-of-contents__link toc-highlight">4. 知识碎片</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5e310ca4.js"></script>
<script src="/assets/js/main.cb284e89.js"></script>
</body>
</html>